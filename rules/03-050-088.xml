<?xml version='1.0'?>
<rules xmlns="http://www.loc.gov/bf2marc"
       xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
       xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
       xmlns:bf="http://id.loc.gov/ontologies/bibframe/"
       xmlns:bflc="http://id.loc.gov/ontologies/bflc/"
       xmlns:madsrdf="http://www.loc.gov/mads/rdf/v1#"
       xmlns:marc="http://www.loc.gov/MARC21/slim"
       xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <df tag="050">
    <context xpath="bf:Work/bf:classification/bf:ClassificationLcc[not(bf:source/bf:Source/rdfs:label='Library and Archives Canada')]">
      <ind1 default=" "/>
      <ind2 default="0">
        <switch>
          <case test="bf:source and bf:source/bf:Source/@rdf:about != 'http://id.loc.gov/vocabulary/organizations/dlc'">4</case>
        </switch>
      </ind2>
      <sf code="a"><select xpath="bf:classificationPortion"/></sf>
      <sf code="b" repeatable="false"><select xpath="bf:itemPortion"/></sf>
    </context>
  </df>

  <df tag="060">
    <context xpath="bf:Work/bf:classification/bf:ClassificationNlm">
      <ind1 default=" "/>
      <ind2 default="4">
        <switch>
          <case test="bf:source/@rdf:resource='http://id.loc.gov/vocabulary/organizations/dnlm' or bf:source/bf:Source/@rdf:about='http://id.loc.gov/vocabulary/organizations/dnlm'">0</case>
        </switch>
      </ind2>
      <sf code="a"><select xpath="bf:classificationPortion"/></sf>
      <sf code="b" repeatable="false"><select xpath="bf:itemPortion"/></sf>
      <sf code="0"><select xpath="@rdf:about"/></sf>
      <sf code="0">
        <select xpath="bf:identifiedBy/bf:Identifier">
          <transform>
            <xsl:variable name="vIdType" select="rdfs:label"/>
            <xsl:choose>
              <xsl:when test="$vIdType != ''"><xsl:value-of select="concat('(',$vIdType,')',rdf:value)"/></xsl:when>
              <xsl:otherwise><xsl:value-of select="rdf:value"/></xsl:otherwise>
            </xsl:choose>
          </transform>
        </select>
      </sf>
    </context>
  </df>

  <df tag="082">
    <context xpath="bf:Work/bf:classification/bf:ClassificationDdc">
      <ind1 default="7">
        <switch>
          <case test="not(bf:edition)">0</case>
          <case test="bf:edition = 'full'">0</case>
          <case test="bf:edition = 'abridged'">1</case>
        </switch>
      </ind1>
      <ind2 default="4">
        <switch>
          <case test="bf:source/@rdf:resource='http://id.loc.gov/vocabulary/organizations/dlc' or bf:source/bf:Source/@rdf:about='http://id.loc.gov/vocabulary/organizations/dlc'">0</case>
        </switch>
      </ind2>
      <sf code="a"><select xpath="bf:classificationPortion"/></sf>
      <sf code="b" repeatable="false"><select xpath="bf:itemPortion"/></sf>
      <sf code="q" repeatable="false"><select xpath="bf:source/bf:Source/rdfs:label"/></sf>
      <sf code="2" repeatable="false"><select xpath="bf:edition[text()!='full' and text()!='abridged']"/></sf>
    </context>
  </df>

</rules>
