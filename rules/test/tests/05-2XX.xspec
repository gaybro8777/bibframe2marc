<?xml version="1.0" encoding="UTF-8"?>

<x:description xmlns:x="http://www.jenitennison.com/xslt/xspec"
               xmlns:marc="http://www.loc.gov/MARC21/slim"
               stylesheet="../../../bibframe2marc.xsl"
               xslt-version="1.0">

  <x:scenario label="MARC 210">
    <x:context href="../data/2XX/210.xml"/>
    <x:expect label="generate 210" test="count(//marc:datafield[@tag='210']) = 1"/>
  </x:scenario>

  <x:scenario label="MARC 222">
    <x:context href="../data/2XX/222.xml"/>
    <x:expect label="generate 222" test="count(//marc:datafield[@tag='222']) = 1"/>
  </x:scenario>

  <x:scenario label="MARC 242">
    <x:context href="../data/2XX/242.xml"/>
    <x:expect label="generate 242" test="count(//marc:datafield[@tag='242']) = 1"/>
  </x:scenario>

  <x:scenario label="MARC 245">
    <x:context href="../data/2XX/245.xml"/>
    <x:expect label="...should be generated from bf:Instance/bf:title/bf:Title"
              test="count(marc:record/marc:datafield[@tag='245']) = 1"/>
    <x:expect label="...ind1 = '1'"
              test="marc:record/marc:datafield[@tag='245']/@ind1 = '1'"/>
    <x:expect label="...ind2 generated by subtracting length of bflc:titleSortKey from rdfs:label"
              test="marc:record/marc:datafield[@tag='245']/@ind2 = '4'"/>
    <x:expect label="...$a generated by bf:mainTitle"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='a'] = 'The man who spoke Snakish'"/>
    <x:expect label="...$b generated by bf:subtitle"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='b'] = 'a novel'"/>
    <x:expect label="...$c generated by bf:Instance/bf:responsibilityStatement"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='c'] = 'by Andrus Kivirähk'"/>
    <x:expect label="...$n generated by bf:partNumber"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='n'] = '1'"/>
    <x:expect label="...$p generated by bf:partName"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='p'] = 'part one'"/>
  </x:scenario>

  <x:scenario label="MARC 245 no bf:mainTitle">
    <x:context href="../data/2XX/245-1.xml"/>
    <x:expect label="...should generate $a from rdfs:label"
              test="marc:record/marc:datafield[@tag='245']/marc:subfield[@code='a'] = 'The man who spoke Snakish : a novel / by Andrus Kivirähk'"/>
  </x:scenario>

  <x:scenario label="MARC 245 only generated if Title not subclassed">
    <x:context href="../data/2XX/245-2.xml"/>
    <x:expect label="No 245 generated"
              test="count(//marc:datafield[@tag='245']) = 0"/>
  </x:scenario>

  <x:scenario label="MARC 246">
    <x:context href="../data/2XX/246.xml"/>
    <x:expect label="generate 246" test="count(//marc:datafield[@tag='246']) = 1"/>
  </x:scenario>

</x:description>
